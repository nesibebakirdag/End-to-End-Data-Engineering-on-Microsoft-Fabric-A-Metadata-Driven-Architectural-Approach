ðŸ™ï¸ Smart City Data Platform: Energy & Environmental Optimization on Microsoft Fabric1. Project Vision & Business LogicThe modern smart city faces a paradox: energy consumption is rising, yet renewable energy sources are volatile. This project focuses on Amsterdamâ€™s energy ecosystem, correlating real-time energy spot prices (EnergyZero) with meteorological conditions (Open-Meteo).The Core Hypothesis:Meteorological Trigger: Wind speed increases.Economic Impact: Renewable energy production surges, causing Spot Prices to drop.Environmental Result: By identifying these "Opportunity Windows," consumers can shift their usage to periods where energy is both cheapest and cleanest.2. Architectural Design: The Medallion FrameworkThe platform is built on Microsoft Fabric OneLake, utilizing the Medallion Architecture to ensure data quality and lineage.Bronze (Raw Zone): Ingests raw JSON data from APIs. It acts as an immutable history of source data.Silver (Standardized Zone): This is the "Engineering Layer." Data is cleaned, schemas are enforced, and complex nested structures are flattened.Gold (Curated Zone): The "Intelligence Layer." Data is aggregated, joined, and enriched with business logic to drive decision-making.3. Engineering Principles: The Modular CoreUnlike static ETL scripts, this project is built using Software Engineering best practices to ensure maintainability and scalability.ðŸ› ï¸ Step-by-Step Notebook AnalysisStep 1: nb_config (The Map)The Single Source of Truth (SSOT) for the entire platform.Logic: Centralizes all ABFSS paths, Lakehouse names, and global parameters.Engineering Value: Eliminates hard-coding. Moving from a Dev to a Prod environment requires changing a single line of code here.Step 2: nb_logging (The Observability)In distributed Spark environments, debugging is the highest cost.Logic: Implements a ContextFilter that automatically tags every log entry with the specific Dataset, Notebook, and Layer being processed.Engineering Value: Provides full transparency into pipeline health and execution duration.Step 3: nb_functions (The Toolkit)A robust library of atomic, reusable functions (DRY Principle):clean_column_names: Uses RegEx to enforce Snake Case formatting.add_md5_id: Generates deterministic Surrogate Keys for high-performance joins.zip_explode_and_flatten: Synchronizes parallel arrays in weather data (Time, Temp, Wind) into single rows without data loss.is_directory_empty: Prevents unnecessary compute costs by checking for data presence before execution.Step 4: nb_bronze_to_silver (The Metadata-Driven Engine)The brain of the transformation layer.Logic: Instead of writing individual code for Energy, Weather, and Air Quality, this notebook uses Configuration Capsules (Dictionaries).The Engine: It reads the config, then dynamically executes Extract -> Simplify -> Datatype -> Meta -> Select.Scalability: Adding a new data source (e.g., Solar Power) requires only a new configuration entry, not a new notebook.Step 5: nb_silver_to_gold (The Analytical Engine)Transforming clean data into Strategic Intelligence.Time Normalization: Aligning disparate datasets (hourly/daily) using date_trunc("hour", col("date")).Window Functions: Calculating the 3-hour moving average to understand price trends.$$\text{Moving Average} = \frac{1}{N} \sum_{i=0}^{N-1} P_{t-i}$$Opportunity Detection: A rule-based engine that tags rows as an "OPPORTUNITY" if:$$\text{Price} < \text{Moving Avg} \quad \text{AND} \quad \text{Wind Speed} > 15 \text{ km/h}$$4. Serving Layer: Power BI & Direct LakeThe final output is served through Microsoft Fabric's Direct Lake technology.Zero-Copy: Data is read directly from OneLake Delta files.Actionable Insights: Decision-makers see real-time "Consume Now" vs. "Wait" indicators based on the current Opportunity Score.
